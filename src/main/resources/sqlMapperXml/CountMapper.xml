<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.dovahkiin.mapper.CountMapper">

    <select id="count1" resultType="java.util.HashMap">
		SELECT
			<choose>
				<when test="type==0">
					DATE_FORMAT( recored_date, '%Y-%m-%d' ) days,
				</when>
				<when test="type==1">
					DATE_FORMAT( recored_date, '%Y-%m' ) days,
				</when>
			</choose>

			sum( `consumption` ) consumption
		FROM video_cost
		<where>
			`consumption` >0 and delete_flag = 0
			and recored_date BETWEEN #{recoredDate_start } and #{recoredDate_end  }

		</where>
		GROUP BY days
	</select>
</mapper>
